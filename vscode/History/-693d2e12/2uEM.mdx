export const metadata = {
  title: 'Deployment and Backup Guide for MongoDB Database on Hostinger VPS',
  description: 'Learn how to deploy and secure MongoDB on a Hostinger VPS with automated local and S3 backups. Step-by-step guide for production-ready setup.',
  keywords: [
    'MongoDB VPS deployment',
    'Hostinger MongoDB setup',
    'MongoDB backup script',
    'MongoDB S3 backup',
    'Ubuntu MongoDB install',
    'MongoDB production server',
    'MongoDB crontab backup',
    'Secure MongoDB VPS',
    'Automated MongoDB backup',
    'MongoDB on Hostinger',
  ],
  openGraph: {
    title: 'Deployment and Backup Guide for MongoDB Database on Hostinger VPS',
    description: 'A complete guide to deploying MongoDB on a Hostinger VPS using Ubuntu. Includes setup, security, and automated backups to AWS S3.',
    url: '[https://yourdomain.com/blogs/mongodb-deploy-and-backup-in-vps](https://yourdomain.com/blogs/mongodb-deploy-and-backup-in-vps)',
    siteName: 'Tariqul Dev Blog',
    locale: 'en_US',
    type: 'article',
  },
};

# Deployment and Backup Guide for MongoDB Database on Hostinger VPS

> A complete step-by-step guide to install, secure, and configure MongoDB on a VPS. Includes local and S3 backup automation for production.

## Prerequisites

- Hostinger VPS (Ubuntu 22.04 or later)
- MongoDB installed
- Optional: AWS CLI configured for backup

## Secure MongoDB

### Create Admin and App Users

```bash
mongosh
use admin
db.createUser({user: "admin", pwd: passwordPrompt(), roles: ["root"]})
use database_name
db.createUser({user:"appuser", pwd:passwordPrompt(), roles:[{role:"readWrite", db:"database_name"}]})
exit
```

### Enable Authorization

```bash
sudo nano /etc/mongod.conf
# Add:
security:
  authorization: enabled
```

Restart MongoDB:

```bash
sudo systemctl restart mongod
```

### Restrict Network Access

```bash
sudo nano /etc/mongod.conf
# In `net` section:
bindIp: 127.0.0.1
```

## Configure UFW Firewall

```bash
sudo ufw enable
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw deny 27017
```

## Install MongoDB 8.0

```bash
sudo apt-get install gnupg curl
curl -fsSL https://www.mongodb.org/static/pgp/server-8.0.asc | \
  sudo gpg -o /usr/share/keyrings/mongodb-server-8.0.gpg --dearmor
echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-8.0.gpg ] https://repo.mongodb.org/apt/ubuntu noble/mongodb-org/8.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-8.0.list
sudo apt-get update && sudo apt-get install -y mongodb-org
sudo systemctl start mongod && sudo systemctl enable mongod
```

## MongoDB Backup Script (Local + S3)

### Local Backup Script

`~/backups/mongodb_backup_database_name.sh`

```bash
#!/bin/bash
BACKUP_DIR=~/backups/mongodb
DB_NAME=database_name
TIMESTAMP=$(date +%F-%H-%M-%S)
BACKUP_NAME="backup-$DB_NAME-$TIMESTAMP.gz"

mongodump --db $DB_NAME --authenticationDatabase database_name -u database_user -p your_secure_password --archive=$BACKUP_DIR/$BACKUP_NAME --gzip
ls -t $BACKUP_DIR/backup-$DB_NAME-*.gz | tail -n +6 | xargs -I {} rm {}
```

Make it executable:

```bash
chmod +x ~/backups/mongodb_backup_database_name.sh
```

### AWS S3 Upload Extension (Optional)

```bash
aws s3 cp $BACKUP_DIR/$BACKUP_NAME s3://your-bucket-name/$BACKUP_NAME
```

## Automate with Cron

```bash
crontab -e
0 * * * * ~/backups/mongodb_backup_database_name.sh
```

## Monitoring & Access

### Check MongoDB status

```bash
sudo systemctl status mongod
```

### Compass Connection String:

```bash
mongodb://username:password@your_server_ip:27017/database_name
```

## Youâ€™re Done!

- MongoDB secured
- Automated backups in place
- Remote access optionally enabled
